<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>문서 | XE3 가이드 문서</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="XE3 가이드 문서">
    <link rel="preload" href="/xe3-doc/assets/css/0.styles.e9ee09ad.css" as="style"><link rel="preload" href="/xe3-doc/assets/js/app.76304fcc.js" as="script"><link rel="preload" href="/xe3-doc/assets/js/2.587667cf.js" as="script"><link rel="preload" href="/xe3-doc/assets/js/71.03cb5805.js" as="script"><link rel="prefetch" href="/xe3-doc/assets/js/10.57948f23.js"><link rel="prefetch" href="/xe3-doc/assets/js/11.fecad70b.js"><link rel="prefetch" href="/xe3-doc/assets/js/12.27a5bb09.js"><link rel="prefetch" href="/xe3-doc/assets/js/13.b172c327.js"><link rel="prefetch" href="/xe3-doc/assets/js/14.da8aaa48.js"><link rel="prefetch" href="/xe3-doc/assets/js/15.0b36b24e.js"><link rel="prefetch" href="/xe3-doc/assets/js/16.fca16dee.js"><link rel="prefetch" href="/xe3-doc/assets/js/17.6305561a.js"><link rel="prefetch" href="/xe3-doc/assets/js/18.a434d577.js"><link rel="prefetch" href="/xe3-doc/assets/js/19.876d6157.js"><link rel="prefetch" href="/xe3-doc/assets/js/20.f53151d0.js"><link rel="prefetch" href="/xe3-doc/assets/js/21.70365815.js"><link rel="prefetch" href="/xe3-doc/assets/js/22.31cf7805.js"><link rel="prefetch" href="/xe3-doc/assets/js/23.40cc3185.js"><link rel="prefetch" href="/xe3-doc/assets/js/24.a06ce1e1.js"><link rel="prefetch" href="/xe3-doc/assets/js/25.09c52c95.js"><link rel="prefetch" href="/xe3-doc/assets/js/26.e75a13d8.js"><link rel="prefetch" href="/xe3-doc/assets/js/27.fa6613e2.js"><link rel="prefetch" href="/xe3-doc/assets/js/28.85af2809.js"><link rel="prefetch" href="/xe3-doc/assets/js/29.afff3386.js"><link rel="prefetch" href="/xe3-doc/assets/js/3.ac98112a.js"><link rel="prefetch" href="/xe3-doc/assets/js/30.f71492bf.js"><link rel="prefetch" href="/xe3-doc/assets/js/31.6240829d.js"><link rel="prefetch" href="/xe3-doc/assets/js/32.3f9c71ea.js"><link rel="prefetch" href="/xe3-doc/assets/js/33.a1d5553c.js"><link rel="prefetch" href="/xe3-doc/assets/js/34.0cba113d.js"><link rel="prefetch" href="/xe3-doc/assets/js/35.0e8fd88d.js"><link rel="prefetch" href="/xe3-doc/assets/js/36.8739696f.js"><link rel="prefetch" href="/xe3-doc/assets/js/37.3e6d3291.js"><link rel="prefetch" href="/xe3-doc/assets/js/38.21071671.js"><link rel="prefetch" href="/xe3-doc/assets/js/39.32947bd9.js"><link rel="prefetch" href="/xe3-doc/assets/js/4.728af792.js"><link rel="prefetch" href="/xe3-doc/assets/js/40.9997bca4.js"><link rel="prefetch" href="/xe3-doc/assets/js/41.8351078e.js"><link rel="prefetch" href="/xe3-doc/assets/js/42.66b591d4.js"><link rel="prefetch" href="/xe3-doc/assets/js/43.4f4d6bc2.js"><link rel="prefetch" href="/xe3-doc/assets/js/44.f690c560.js"><link rel="prefetch" href="/xe3-doc/assets/js/45.d1992aa2.js"><link rel="prefetch" href="/xe3-doc/assets/js/46.3f0a5770.js"><link rel="prefetch" href="/xe3-doc/assets/js/47.129b2e11.js"><link rel="prefetch" href="/xe3-doc/assets/js/48.71b19ee6.js"><link rel="prefetch" href="/xe3-doc/assets/js/49.6547541b.js"><link rel="prefetch" href="/xe3-doc/assets/js/5.5585d8d7.js"><link rel="prefetch" href="/xe3-doc/assets/js/50.32e695cb.js"><link rel="prefetch" href="/xe3-doc/assets/js/51.b1fd9d73.js"><link rel="prefetch" href="/xe3-doc/assets/js/52.bf53132e.js"><link rel="prefetch" href="/xe3-doc/assets/js/53.44be3848.js"><link rel="prefetch" href="/xe3-doc/assets/js/54.bafd8858.js"><link rel="prefetch" href="/xe3-doc/assets/js/55.1b418742.js"><link rel="prefetch" href="/xe3-doc/assets/js/56.2c5bf17c.js"><link rel="prefetch" href="/xe3-doc/assets/js/57.944f11f0.js"><link rel="prefetch" href="/xe3-doc/assets/js/58.f0464f72.js"><link rel="prefetch" href="/xe3-doc/assets/js/59.9c31cf3e.js"><link rel="prefetch" href="/xe3-doc/assets/js/6.6714d407.js"><link rel="prefetch" href="/xe3-doc/assets/js/60.bfce6280.js"><link rel="prefetch" href="/xe3-doc/assets/js/61.4d2fe3d4.js"><link rel="prefetch" href="/xe3-doc/assets/js/62.c91dbea7.js"><link rel="prefetch" href="/xe3-doc/assets/js/63.60391993.js"><link rel="prefetch" href="/xe3-doc/assets/js/64.530ec0c5.js"><link rel="prefetch" href="/xe3-doc/assets/js/65.dd2cc186.js"><link rel="prefetch" href="/xe3-doc/assets/js/66.374a6caa.js"><link rel="prefetch" href="/xe3-doc/assets/js/67.a6a27ac6.js"><link rel="prefetch" href="/xe3-doc/assets/js/68.69e9dfc2.js"><link rel="prefetch" href="/xe3-doc/assets/js/69.4aed424e.js"><link rel="prefetch" href="/xe3-doc/assets/js/7.f7226d2c.js"><link rel="prefetch" href="/xe3-doc/assets/js/70.2295f984.js"><link rel="prefetch" href="/xe3-doc/assets/js/72.194fd677.js"><link rel="prefetch" href="/xe3-doc/assets/js/73.8f5c98e5.js"><link rel="prefetch" href="/xe3-doc/assets/js/74.6b6732d8.js"><link rel="prefetch" href="/xe3-doc/assets/js/75.1e8c041c.js"><link rel="prefetch" href="/xe3-doc/assets/js/76.cc2ec3c1.js"><link rel="prefetch" href="/xe3-doc/assets/js/77.f2997c1a.js"><link rel="prefetch" href="/xe3-doc/assets/js/78.1789b79e.js"><link rel="prefetch" href="/xe3-doc/assets/js/79.f43d2ef6.js"><link rel="prefetch" href="/xe3-doc/assets/js/8.817a7cc8.js"><link rel="prefetch" href="/xe3-doc/assets/js/80.51578898.js"><link rel="prefetch" href="/xe3-doc/assets/js/81.e8ef26a1.js"><link rel="prefetch" href="/xe3-doc/assets/js/82.522bbb94.js"><link rel="prefetch" href="/xe3-doc/assets/js/83.c1bfa961.js"><link rel="prefetch" href="/xe3-doc/assets/js/84.94c055fc.js"><link rel="prefetch" href="/xe3-doc/assets/js/85.f5144183.js"><link rel="prefetch" href="/xe3-doc/assets/js/86.7db8b9b0.js"><link rel="prefetch" href="/xe3-doc/assets/js/87.d7ed73b8.js"><link rel="prefetch" href="/xe3-doc/assets/js/88.9b0d7040.js"><link rel="prefetch" href="/xe3-doc/assets/js/89.6c40ec6f.js"><link rel="prefetch" href="/xe3-doc/assets/js/9.7a2c1fcd.js"><link rel="prefetch" href="/xe3-doc/assets/js/90.f7f4b6ef.js"><link rel="prefetch" href="/xe3-doc/assets/js/91.71e51af9.js"><link rel="prefetch" href="/xe3-doc/assets/js/92.516c562c.js"><link rel="prefetch" href="/xe3-doc/assets/js/93.1536d71b.js"><link rel="prefetch" href="/xe3-doc/assets/js/94.8adeb6a2.js"><link rel="prefetch" href="/xe3-doc/assets/js/95.0b36db94.js"><link rel="prefetch" href="/xe3-doc/assets/js/96.88acae77.js"><link rel="prefetch" href="/xe3-doc/assets/js/97.71b06025.js"><link rel="prefetch" href="/xe3-doc/assets/js/98.c474de82.js">
    <link rel="stylesheet" href="/xe3-doc/assets/css/0.styles.e9ee09ad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/xe3-doc/" class="home-link router-link-active"><!----> <span class="site-name">XE3 가이드 문서</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/xe3-doc/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 시작하기</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 사이트 설정</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 번들 플러그인</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 개발자 문서</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 플러그인 개발</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 테마 개발&amp;제작</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 스킨 개발&amp;제작</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span> 서비스</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/xe3-doc/08.%20%EC%84%9C%EB%B9%84%EC%8A%A4/" aria-current="page" class="sidebar-link">서비스</a></li><li><a href="/xe3-doc/08. 서비스/service-captcha.html" class="sidebar-link">캡챠</a></li><li><a href="/xe3-doc/08. 서비스/service-category.html" class="sidebar-link">카테고리</a></li><li><a href="/xe3-doc/08. 서비스/service-config.html" class="sidebar-link">설정</a></li><li><a href="/xe3-doc/08. 서비스/service-cookie.html" class="sidebar-link">쿠키</a></li><li><a href="/xe3-doc/08. 서비스/service-counter.html" class="sidebar-link">카운터</a></li><li><a href="/xe3-doc/08. 서비스/service-database.html" class="sidebar-link">데이터베이스</a></li><li><a href="/xe3-doc/08. 서비스/service-document.html" class="active sidebar-link">문서</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xe3-doc/08. 서비스/service-document.html#문서-document" class="sidebar-link">문서\(document\)</a></li></ul></li><li><a href="/xe3-doc/08. 서비스/service-error_catch.html" class="sidebar-link">오류처리</a></li><li><a href="/xe3-doc/08. 서비스/service-event_interception.html" class="sidebar-link">이벤트/인터셉션</a></li><li><a href="/xe3-doc/08. 서비스/service-file_storage.html" class="sidebar-link">파일/스토리지</a></li><li><a href="/xe3-doc/08. 서비스/service-frontend.html" class="sidebar-link">프론트엔드</a></li><li><a href="/xe3-doc/08. 서비스/service-helper.html" class="sidebar-link">헬퍼</a></li><li><a href="/xe3-doc/08. 서비스/service-image-process.html" class="sidebar-link">이미지처리</a></li><li><a href="/xe3-doc/08. 서비스/service-keygen.html" class="sidebar-link">키생성\(Keygen\)</a></li><li><a href="/xe3-doc/08. 서비스/service-mail.html" class="sidebar-link">메일</a></li><li><a href="/xe3-doc/08. 서비스/service-member_auth.html" class="sidebar-link">회원/인증</a></li><li><a href="/xe3-doc/08. 서비스/service-menu_module.html" class="sidebar-link">메뉴/모듈</a></li><li><a href="/xe3-doc/08. 서비스/service-mobile.html" class="sidebar-link">모바일</a></li><li><a href="/xe3-doc/08. 서비스/service-permission.html" class="sidebar-link">권한</a></li><li><a href="/xe3-doc/08. 서비스/service-session.html" class="sidebar-link">세션</a></li><li><a href="/xe3-doc/08. 서비스/service-themes.html" class="sidebar-link">테마</a></li><li><a href="/xe3-doc/08. 서비스/service-trash.html" class="sidebar-link">휴지통</a></li><li><a href="/xe3-doc/08. 서비스/service-uiobject_form.html" class="sidebar-link">UI오브젝트/폼빌더</a></li><li><a href="/xe3-doc/08. 서비스/service-validation.html" class="sidebar-link">유효성검사</a></li><li><a href="/xe3-doc/08. 서비스/service-widget_box.html" class="sidebar-link">위젯박스</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span> 프론트엔드 (js)</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/xe3-doc/LICENSE.html" class="sidebar-link">/LICENSE.html</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="문서"><a href="#문서" class="header-anchor">#</a> 문서</h1> <h2 id="문서-document"><a href="#문서-document" class="header-anchor">#</a> 문서(document)</h2> <p>사이트에서 생산되는 게시판, 블로그, 댓글등 다양한 형태의 컨텐츠를 저장할 저장소를 제공합니다. DocumentHandler 는 Document, Revision 모델을 이용해서 컨텐츠 변경이력을 관리할 수 있는 기능을 제공하고 저장소의 부하분산을 위한 Division(저장소 분할) 저장소를 제공합니다. 이러한 기능은 instanceId 에 따라 설정을 추가해서 관리할 수 있습니다.</p> <p>또한 Document 모델은 DynamicField 를 지원합니다.</p> <p>DocumentHandler, InstanceManager, ConfigHandler 는 Interception Proxy로 만들어 사용되므로 인터셉트 할 수 있습니다. (인터셉트하기)</p> <h3 id="기본-사용법"><a href="#기본-사용법" class="header-anchor">#</a> 기본 사용법</h3> <p><code>XeDocument</code>파사드로 DocumentHandler 를 사용합니다. 문서 등록, 수정, 삭제는 DocumentHandler를 이용해서 처리하고 문서 조회는 Document 모델을 직접 사용합니다. 단, 인스턴스를 생성해 사용할 경우 Document 모델에 대한 설정을 모델에 포함시키기 위해 <code>XeDocument::getModel($instnaceId)</code> 를 사용하기를 권장합니다.</p> <h4 id="모든-문서-가져오기"><a href="#모든-문서-가져오기" class="header-anchor">#</a> 모든 문서 가져오기</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$doc</span> <span class="token operator">=</span> Document<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="primary-key를-통해서-하나의-레코드-가져오기"><a href="#primary-key를-통해서-하나의-레코드-가져오기" class="header-anchor">#</a> Primary Key를 통해서 하나의 레코드 가져오기</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$doc</span> <span class="token operator">=</span> Document<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$documentId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="인스턴스-생성을-통해-등록된-문서-가져오기"><a href="#인스턴스-생성을-통해-등록된-문서-가져오기" class="header-anchor">#</a> 인스턴스 생성을 통해 등록된 문서 가져오기</h4> <p>메뉴를 통해 인스턴스가 생성되었거나 또는 어떤 방식으로든 <code>InstanceManager</code> 를 이용해 인스턴스를 만들어 설정을 사용하는 경우에는 모델을 직접 사용하지 말고 <code>DocumentHandler</code>를 통해 획득한 모델을 사용하도록 해야합니다.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$model</span> <span class="token operator">=</span> XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token variable">$instanceId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 10개의 문서를 가져옵니다.</span>
<span class="token variable">$model</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">paginate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>이렇게 획득한 모델은 설정에 대한 정보를 포함하고 있으며 <code>revision</code>, <code>division</code> 에 대한 처리 및 Database Proxy를 이용하는 기능인 DynamiField 에 대한 처리가 가능합니다.</p> <h4 id="문서-등록"><a href="#문서-등록" class="header-anchor">#</a> 문서 등록</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'instanceId'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$instanceId</span><span class="token punctuation">;</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'제목'</span><span class="token punctuation">;</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'내용'</span><span class="token punctuation">;</span>
<span class="token variable">$inputs</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'userId'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Auth<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$inputs</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'writer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Auth<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>문서 등록은 Document 모델을 직접 사용하지 않고 DocumentHandler 를 통해서 처리합니다. 이는 문서 저장할 때 인터셉트할 수 있는 포인트를 제공하며 Document 가 입력값 검사 및 <code>revision</code> 을 처리합니다.</p> <h4 id="수정하기"><a href="#수정하기" class="header-anchor">#</a> 수정하기</h4> <p>Document를 통해 문서를 직접가져오는 경우는 아래와 같이 <code>XeDocument::setModelConfig()</code>를 이용해서 모델에 설정을 삽입해야 <code>DocumentHandler</code> 에서 설정에 따른 처리를 이상없이 수행할 수 있습니다.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$doc</span> <span class="token operator">=</span> Document<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$documentId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$doc</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'제목 수정'</span><span class="token punctuation">;</span>

<span class="token comment">// Document 모델($doc)에 설정 삽입</span>
XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setModelConfig</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token punctuation">,</span> <span class="token variable">$doc</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">instanceId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>일반적인 상태에서 문서를 찾을 때 라이프 사이클 상에서 instanceId 를 확보할 수 있다고 가정한다면 아래 형식의 코드를 사용할 수 있습니다.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$doc</span> <span class="token operator">=</span> XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token variable">$instanceId</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$documentId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$doc</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'제목 수정'</span><span class="token punctuation">;</span>

XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="삭제하기"><a href="#삭제하기" class="header-anchor">#</a> 삭제하기</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$doc</span> <span class="token operator">=</span> Document<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$documentId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Document 모델($doc)에 설정 삽입</span>
XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setModelConfig</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token punctuation">,</span> <span class="token variable">$doc</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">instanceId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// '937c2ec7' 은 인스턴스 아이디</span>
<span class="token variable">$doc</span> <span class="token operator">=</span> XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token variable">$instanceId</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$documentId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token variable">$doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="인스턴스"><a href="#인스턴스" class="header-anchor">#</a> 인스턴스</h3> <p>관리자 &gt; 사이트 메뉴에서 게시판을 만들 때 게시판 플러그인은 Document 서비스 를 사용하기 위해 Document 인스턴스를 만듭니다. Document 를 사용하기 위한 설정 및 그에 필요한 주변 요소를 생성해서 실제 사용가능한 형태로 만드는 것입니다.</p> <h4 id="인스턴스-생성"><a href="#인스턴스-생성" class="header-anchor">#</a> 인스턴스 생성</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'revision'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'division'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token variable">$instanceId</span><span class="token punctuation">,</span> <span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Document 에 설정 요소를 <code>$params</code>로 전달합니다.</p> <h4 id="인스턴스-제거"><a href="#인스턴스-제거" class="header-anchor">#</a> 인스턴스 제거</h4> <div class="language-php extra-class"><pre class="language-php"><code>XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">destroyInstance</span><span class="token punctuation">(</span><span class="token variable">$instanceId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>생성된 인스턴스를 제거하며 인스턴스 아이디로 저장된 문서를 삭제합니다. 이것은 게시판 삭제와 같은 처리를 할 때 사용됩니다.</p> <h3 id="document-모델"><a href="#document-모델" class="header-anchor">#</a> Document 모델</h3> <p>데이터를 저장할 때 사용하는 이것은 DynamicQuery 를 처리하기 위해 Config를 등록하는 기능과 문서를 처리할 때 유용한 다양한 메소드를 지원합니다.</p> <h4 id="테이블-부하분산"><a href="#테이블-부하분산" class="header-anchor">#</a> 테이블 부하분산</h4> <p><code>Document::setConfig()</code> 하는 과정에서 테이블 부하분산 처리를 위해 실제 사용할 테이블 이름을 변견할 수 있도록 지원합니다. 이 기능은 <code>DocumentHandler::setModelConfig()</code> 할 때 처리됩니다.</p> <h4 id="다양한-상태값"><a href="#다양한-상태값" class="header-anchor">#</a> 다양한 상태값</h4> <p>상태를 표시하기 위한 다양한 컬럼을 갖고 있습니다.</p> <ul><li>status : 문서의 상태를 저장합니다. (휴지통, 임시저장, 비공개, 공개, 공지)</li> <li>approved : 승인에 대한 설정을 저장합니다. (거절됨, 기다림, 허용됨)</li> <li>published : 발행에 대한 설정을 저장합니다. (거절됨, 기다림, 예약발행, 발행됨)</li> <li>display : 보여지는 상태에 대한 설정을 저장합니다. (숨김, 비밀, 보여짐)</li></ul> <p>이 상태값들을 복합적으로 사용하여 플러그인 자체적으로 다양한 방식의 상태를 표현할 수 있습니다. 그 중에 일반적으로 사용되는 <code>보여짐</code>, <code>숨김</code>, <code>발행</code> 등 다양한 형태의 상태값들을 제안하기 위한 메소드들이 추가되어 있습니다.</p> <p>각 설정은 숫자로 정의되어 있으며 between 쿼리를 이용해서 더 다양한 설정을 사용할 수 있기를 바라고 있습니다. 서드파티 플러그인에서 Document 모델을 확장하는 <code>ExtendDocument</code> 모델을 만들고 상태를 추가하여 더 다양한 형태의 문서 상태 처리 방법이 제공될 수 있기를 바랍니다.</p> <h4 id="format"><a href="#format" class="header-anchor">#</a> format</h4> <p>문서를 출력할 때 어떤 형태의 포멧으로 처리해야할 지 알려주기 위해서 글 저장할 때 format 을 등록하도록 하고 있습니다. 이것은 스마트 에디터를 사용하거나 혹은 마크다운으로 작성된 문서를 구분하고 저장된 내용을 출력할 때 어떤 방식으로 처리해야할 지 결정할 때 유용하게 사용될 것입니다. 현재의 포멧은 HTML 형식만 정의하고 있습니다.</p> <h4 id="reply"><a href="#reply" class="header-anchor">#</a> reply</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// 상위 글</span>
<span class="token variable">$doc</span> <span class="token operator">=</span> XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token variable">$instanceId</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$documentId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// parentId 등록</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'parentId'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$doc</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">;</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'instanceId'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'937c2ec7'</span><span class="token punctuation">;</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'제목'</span><span class="token punctuation">;</span>
<span class="token variable">$params</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'내용'</span><span class="token punctuation">;</span>
<span class="token variable">$inputs</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'userId'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Auth<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$inputs</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'writer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Auth<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

XeDocument<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>답글 처리를 위해 <code>Document::setReply()</code>를 제공합니다. 어떤 문서의 하위로 글을 작성하려고 한다면 해당 모델에 <code>parentId</code>를 놓고 저장하면 됩니다. <code>Document::setReply()</code>의 실행은 <code>/app/Providers/DocumentServiceProvider.php</code> 의 <code>boot()</code>에서 <code>Illuminate\Database\Eloquent\Model</code> 의 <code>creating</code> 이벤트 리스너를 등록해서 자동으로 처리됩니다.</p> <h4 id="division-지원"><a href="#division-지원" class="header-anchor">#</a> Division 지원</h4> <p>테이블 분리 기능을 처리하기 위해 Document 모델은 문서 등록, 수정, 삭제할 때 설정 값을 확인하고 추가적인 처리를 진행합니다. <code>Illuminate\Database\Eloquent\Model</code> 에서 제공하는 <code>performInsert()</code>, <code>performUpdate()</code>, <code>performDeleteOnModel()</code> 기능을 이용해 데이터베이스에 처리될 때 추가적인 코드를 처리합니다.</p> <h4 id="관계"><a href="#관계" class="header-anchor">#</a> 관계</h4> <p>Document 모델은 User(회원)에 대한 관계만 제공합니다. 더 많은 릴레이션은 제공하지 않습니다. 더 많은 모델의 릴레이션을 사용하기 위해서는 게시판 플러그인의 Board 모델과 같이 Document 모델을 확장해서 사용하는것을 권장합니다.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/xe3-doc/08. 서비스/service-database.html" class="prev">
        데이터베이스
      </a></span> <span class="next"><a href="/xe3-doc/08. 서비스/service-error_catch.html">
        오류처리
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/xe3-doc/assets/js/app.76304fcc.js" defer></script><script src="/xe3-doc/assets/js/2.587667cf.js" defer></script><script src="/xe3-doc/assets/js/71.03cb5805.js" defer></script>
  </body>
</html>
